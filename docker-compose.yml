services:
  bombsquad-server:
    build:
      context: .
      tags:
        - "bombsquad-server:${COMPOSE_PROJECT_NAME:-default}"
    container_name: "${COMPOSE_PROJECT_NAME:-bombsquad}-server"
    restart: unless-stopped
    ports:
      - "${PORT:-6666}:${PORT:-6666}/udp"
    volumes:
      # Mount config file for easy editing
      - ./config.toml:/app/config.toml
      # Persist server data
      - ./dist/ba_root/mods:/app/dist/ba_root/mods
      # Persist player data
      - bombsquad-data:/app/dist/ba_root
    environment:
      - TZ=UTC
    networks:
      - bombsquad-network

volumes:
  bombsquad-data:
    name: "${COMPOSE_PROJECT_NAME:-bombsquad}-data"
    driver: local

networks:
  bombsquad-network:
    name: "${COMPOSE_PROJECT_NAME:-bombsquad}-network"
    driver: bridge
